<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Books Network | Ganesan Santhanam</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="https://unpkg.com/lucide@latest"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script src="nodes.js"></script>
    <script src="edges.js"></script>
    <script>
        // Tailwind dark mode configuration
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'notion-dark': '#191919',
                        'notion-dark-card': '#2F2F2F',
                        'notion-dark-text': '#E3E3E3',
                        'notion-dark-subtle': '#A5A5A5'
                    }
                }
            }
        }
    </script>

    <style>
        /* Base styles */
        body { 
            font-family: 'Inter', sans-serif; 
            transition: background-color 0.3s ease;
            overflow: hidden; /* Prevent scrollbars from layout shift */
        }
        /* Custom scrollbar for a consistent feel */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        .dark ::-webkit-scrollbar-track { background: #1F1F1F; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .dark ::-webkit-scrollbar-thumb { background: #4a4a4a; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .dark ::-webkit-scrollbar-thumb:hover { background: #64748b; }
        
        /* Vis.js network container */
        #mynetwork {
            width: 100vw;
            height: calc(100vh - 4rem); /* Full viewport height minus header */
            border: none;
            transition: background-color 0.3s ease;
        }

        /* Light Theme for Network */
        html:not(.dark) #mynetwork {
            background-color: #f8fafc; /* slate-50 */
        }
        
        /* Dark Theme for Network */
        html.dark #mynetwork {
            background-color: #191919; /* notion-dark */
        }

        /* Loading bar styles (unchanged) */
        #loadingBar { position:absolute; top:4rem; left:0px; width: 100%; height: calc(100vh - 4rem); background-color:rgba(200,200,200,0.8); -webkit-transition: all 0.5s ease; transition: all 0.5s ease; opacity:1; z-index: 100; }
        html.dark #loadingBar { background-color: rgba(25, 25, 25, 0.8); }
        #bar { position:absolute; top:0px; left:0px; width:20px; height:20px; margin:auto; border-radius:11px; border:2px solid rgba(30,30,30,0.05); background: rgb(0, 173, 246); box-shadow: 2px 0px 4px rgba(0,0,0,0.4); }
        #border { position:absolute; top:10px; left:10px; width:500px; height:23px; margin:auto; box-shadow: 0px 0px 4px rgba(0,0,0,0.2); border-radius:10px; }
        #text { position:absolute; top:8px; left:530px; width:30px; height:50px; margin:auto; font-size:22px; color: #000000; }
        html.dark #text { color: #E3E3E3; }
        div.outerBorder { position:relative; top:50%; transform: translateY(-50%); width:600px; height:44px; margin:auto; border:8px solid rgba(0,0,0,0.1); background: rgb(252,252,252); background: linear-gradient(to bottom,  rgba(252,252,252,1) 0%,rgba(237,237,237,1) 100%); border-radius:72px; box-shadow: 0px 0px 10px rgba(0,0,0,0.2); }
        html.dark div.outerBorder { background: #2F2F2F; border-color: rgba(255,255,255,0.1); }
    </style>
</head>
<body class="bg-white dark:bg-notion-dark text-slate-900 dark:text-notion-dark-text">

    <header class="bg-white/70 dark:bg-notion-dark/70 backdrop-blur-lg sticky top-0 z-50 border-b border-slate-200 dark:border-slate-800 h-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <a href="index.html" class="text-slate-600 dark:text-notion-dark-subtle hover:text-indigo-600 dark:hover:text-white transition flex items-center">
                    <i data-lucide="arrow-left" class="w-4 h-4 mr-2"></i>
                    Back to Home
                </a>
                <div class="flex items-center">
                     <button id="theme-toggle" class="p-2 rounded-md text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        <svg id="theme-toggle-dark-icon" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                        <svg id="theme-toggle-light-icon" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="relative">
            <div id="mynetwork"></div>
            <div id="loadingBar">
              <div class="outerBorder">
                <div id="text">0%</div>
                <div id="border">
                  <div id="bar"></div>
                </div>
              </div>
            </div>
        </div>
    </main>

    <script type="text/javascript">
          var network = null;
        //   var allNodeData = null;
        //   var allEdgeData = null;

          function destroyNetwork() {
            if (network !== null) {
              network.destroy();
              network = null;
            }
          }

          function drawGraph() {
              destroyNetwork(); // Clean up previous network instance

              var container = document.getElementById('mynetwork');
              var isDarkMode = document.documentElement.classList.contains('dark');
              var nodeFontColor = isDarkMode ? '#E3E3E3' : '#1e293b';
              
              if (!allNodeData) {
                  // This is a placeholder for your massive node list.
                  // It should contain your full list of nodes.
                  allNodeData = [{"group": "General", "id": "The Lords of Easy Money How the Federal Reserve Br", "label": "The Lords of Easy Money: How the Federal Reserve Broke the American Economy", "shape": "dot", "title": "\n        \u003cdiv style=\"font-family: Arial, sans-serif; max-width: 300px;\"\u003e\n            \u003ch4 style=\"margin: 0 0 5px 0; color: #1E90FF;\"\u003eThe Lords of Easy Money: How the Federal Reserve Broke the American Economy\u003c/h4\u003e\n            \u003cp style=\"margin: 0;\"\u003e\u003cb\u003eAuthor:\u003c/b\u003e Christopher Leonard\u003c/p\u003e\n            \u003cp style=\"margin: 0;\"\u003e\u003cb\u003eRating:\u003c/b\u003e Not Rated\u003c/p\u003e\n            \u003cp style=\"margin: 0;\"\u003e\u003cb\u003eGenre:\u003c/b\u003e General\u003c/p\u003e\n        \u003c/div\u003e\n        ", "value": 15}, /* ... PASTE ALL YOUR OTHER NODES HERE ... */ {"group": "Medium Book", "id": "The Space Barons Elon Musk Jeff Bezos and the Ques", "label": "The Space Barons: Elon Musk, Jeff Bezos, and the Quest to Colonize the Cosmos", "shape": "dot", "title": "\n        \u003cdiv style=\"font-family: Arial, sans-serif; max-width: 300px;\"\u003e\n            \u003ch4 style=\"margin: 0 0 5px 0; color: #1E90FF;\"\u003eThe Space Barons: Elon Musk, Jeff Bezos, and the Quest to Colonize the Cosmos\u003c/h4\u003e\n            \u003cp style=\"margin: 0;\"\u003e\u003cb\u003eAuthor:\u003c/b\u003e Christian Davenport\u003c/p\u003e\n            \u003cp style=\"margin: 0;\"\u003e\u003cb\u003eRating:\u003c/b\u003e Not Rated\u003c/p\u003e\n            \u003cp style=\"margin: 0;\"\u003e\u003cb\u003eGenre:\u003c/b\u003e Medium Book\u003c/p\u003e\n        \u003c/div\u003e\n        ", "value": 15}];
              }
              
              if (!allEdgeData) {
                  // This is a placeholder for your massive edge list.
                  // It should contain your full list of edges.
                  allEdgeData = [{"from": "Infinity Reaper Infinity Cycle 2", "to": "Infinity Son Infinity Cycle 1", "value": 1}, /* ... PASTE ALL YOUR OTHER EDGES HERE ... */ {"from": "Sleeping Giants Themis Files 1", "to": "Only Human Themis Files 3", "value": 1}];
              }

              const themedNodes = allNodeData.map(node => ({
                  ...node,
                  font: { color: nodeFontColor }
              }));
              
              var nodes = new vis.DataSet(themedNodes);
              var edges = new vis.DataSet(allEdgeData);

              var data = {nodes: nodes, edges: edges};

              var options = {
                  "edges": { "color": { "inherit": true }, "smooth": { "enabled": true, "type": "dynamic" } },
                  "interaction": { "dragNodes": true, "hideEdgesOnDrag": false, "hideNodesOnDrag": false },
                  "physics": {
                      "enabled": true,
                      "forceAtlas2Based": { "avoidOverlap": 1, "centralGravity": 0.015, "damping": 0.5, "gravitationalConstant": -50, "springConstant": 0.08, "springLength": 150 },
                      "solver": "forceAtlas2Based",
                      "stabilization": { "enabled": true, "fit": true, "iterations": 1000, "onlyDynamicEdges": false, "updateInterval": 50 }
                  }
              };

              network = new vis.Network(container, data, options);

              network.on("stabilizationProgress", function(params) {
                  document.getElementById('loadingBar').style.display = 'block';
                  var maxWidth = 496;
                  var minWidth = 20;
                  var widthFactor = params.iterations / params.total;
                  var width = Math.max(minWidth, maxWidth * widthFactor);
                  document.getElementById('bar').style.width = width + 'px';
                  document.getElementById('text').innerHTML = Math.round(widthFactor*100) + '%';
              });

              network.once("stabilizationIterationsDone", function() {
                  document.getElementById('text').innerHTML = '100%';
                  document.getElementById('bar').style.width = '496px';
                  document.getElementById('loadingBar').style.opacity = 0;
                  setTimeout(function () { document.getElementById('loadingBar').style.display = 'none'; }, 500);
              });
          }
          
          // --- THEME-TOGGLE LOGIC ---
          lucide.createIcons();
          const themeToggleBtn = document.getElementById('theme-toggle');
          const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
          const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

          function applyTheme(theme, isInitialLoad = false) {
              if (theme === 'dark') {
                  document.documentElement.classList.add('dark');
                  themeToggleLightIcon.classList.remove('hidden');
                  themeToggleDarkIcon.classList.add('hidden');
              } else {
                  document.documentElement.classList.remove('dark');
                  themeToggleDarkIcon.classList.remove('hidden');
                  themeToggleLightIcon.classList.add('hidden');
              }
              // Only draw the graph if it's not the initial page load,
              // or if the network hasn't been drawn yet.
              if (!isInitialLoad || network === null) {
                  drawGraph();
              }
          }

          themeToggleBtn.addEventListener('click', function() {
              const newTheme = document.documentElement.classList.contains('dark') ? 'light' : 'dark';
              localStorage.setItem('color-theme', newTheme);
              applyTheme(newTheme);
          });

          // Initial Load
          let currentTheme = localStorage.getItem('color-theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
          applyTheme(currentTheme, true);

    </script>
</body>
</html>